# 주석을 잘 쓰는 방법

> 주석의 목적은 코드를 읽는 사람이 코드를 작성한 사람만큼 코드를 잘 이해하게 돕는데 있다. 



## 적지말아야할 주석

1. 코드에서 빠르게 유추할 수 있는 내용은 주석을 달지말라

   - 차라리 아래와 같이 더 중요한 세부사항을 적는것이 낫다.

   - ```
     // 주어진 'name' 으로 노드를 찾거나 아니면 NULL을 반환.
     // 만약 depth <= 0 이면 subtree 만 검색됨.
     // 만약 depth -- N 이면 N 레벨 아래만 검색됨.
     Node* FindNodeInSubtree(Node* subtree, String name, int depth)
     ```

2. 나쁜이름에 주석을 달지말라 → 이름을 고쳐라



## 무엇을 설명해야하는가?

1. 생각을 기록하라.

   ```
   // 놀랍게도, 이 데이터에서 이진트리는 해시 테이블보다 40% 정도 빠르다.
   // 해시를 계산하는 비용이 좌우 비교를 능가함.
   -> 이 주석을 읽으면  이코드는 최적화가 불필요함을 바로 알 수 있다.
   
   // 이 주먹구구식 논리는 몇가지 단어를 생략할 수 있다. 상관없다. 100% 해결은 쉽지않다.
   -> 이 주석이 없으면 이코드를 읽는 사람은 버그가 있는 줄 알고 실패를 찾기 위한 테스트 케이스를 자거나 버그를 수정하는데 시간을 쓸지 모른다.
       하지만 이 주석을 통해 이 코드는 지금 상태로도 괜찮다는 것을 알 수 있다.
   
   // 이 클래스는 점점 엉망이 되어가고 있다. 어쩌면 'ResourceNode'  하위 클래스를 만들어서 정리해야 할지도 모르겠다.
   -> 이 주석은 다른 사람에게 어떻게 수정해야 할지 가이드를 제시해준다.
   ```



2. 코드에 있는 결함을 설명하라.

   > 훗날 수정할 거라는 생각이 드는 부분이 있으면 이러한 생각을 주석으로 작성하는것이 좋다
   >
   > ```
   > // TODO: 더 빠른 알고리즘을 사용하다.
   > // TODO : Jpeg말고 다른 이미지 포맷도 처리할 수 있어야한다.
   > ```



3. 상수에 대한 설명

   ```
   NUM_THREADS = 8 // 이 상수값이 2*num_processors 보다 크거나 같으면 된다.
   -> 상수를 어떤 식으로 변경해야하는 지 알 수 있다.
   
   image_quality = 0.72; // 사용자들은 0.72가 크기/해상도 대비 최선이라고 생각한다.
   -> 상수가 최적임을 알고 변경을 자제해야함을 알 수 있다.
   ```



## 코드를 읽는 사람의 입장이 되어라

1. 나올것 같은 질문 예측하기

   > 작성한 코드를 읽고 뭐하는 코드인지 궁금해 할 것 같은 부분에 주석을 적는다. 
   >
   > ```
   > void Clear() {
   > // 벡터가 메모리를 반납하도록 강제한다. ("STL swap trick" 을 보라.)
   >   -> 코드를 보고 왜 data.clear()를 호출하지 않고 빈데이터와 swap 하는 지 궁금할 것이다. 
   >      이는 vector가 메모리 할당자에게 자신의 메모리를 실제로 반납하게 하는 유일한 방법. C++ 의 특유사항이다.
   > vector<float>().swap(data);
   > }
   > ```



2. 사람들이 빠질 것 같은 함정을 경고

   > ```
   > // 외부 서비스를 호출하여 이메일 서비스를 호출한다. (1분 이후 타임아웃된다.)
   >   -> 외부 서비스로 이메일 서비스를 호출하기 때문에 느릴 수도 연결타임이 발생할 수 있음을 예측할 수 있고, 타임아웃시간이 1분 임을 알 수 있다.
   > void SendEmail(string to, string subject, string body);
   > ```
   >
   > ```
   > // 실행시간이 0(nuber_tags * average_tag_depth)이므로 엉망으로 중첩된 입력을 사용할 때는 주의 할 것.
   >   -> 제대로 작성되지 않은 HTML 에 닫기 태그를 삽입하는 함수이지만, 겹겹의 중첩된 태그에서는 시간이 많이 걸린다는 것을 알 수 있다.
   > def FixBrokenHtml(html);
   > ```



3. 큰 그림을 알려주는 주석

   > 코드 베이스를 개략적으로 보여주는 주석으로써, 보통 특정클래스나 파일의 처음에 주로 작성된다.
   >
   > ```
   > 상위수준 주석의 예
   > // 비지니스 로직과 데이터 베이스를 연결해주는 코드. 애플리케이션 코드에서는 직접이용하면 안됨.
   > // 아래 클래스는 스마트 캐시 임. 시스템의 다른 부분은 전혀모르는 코드.
   > 
   > 파일수준 주석의 예
   > // 파일시스템에 편리한 인터페이스를 제공하는 헬퍼함수들을 담고 있다.
   > // 파일의 퍼미션과 다른 자세한 세부사항을 처리한다.
   > ```

   > 또는 하위수준 코드의 내용을 간결하게 요약한 내용을 주석으로 적어, 함수 동작의 큰 그림을 설명할 수도 있다.
   >
   > ```
   > // 고객이 자신을 위해 구입한 항목 모두를 찾는다.
   > for customer_id in all_customers:
   > 	for sale in all_sales[customer_id].sales:
   > 		if sale.recipient == customer_id:
   > ```

   > 몇몇 덩어리로 이루어진 긴 함수의 경우는 덩어리별로 요약 주석을 달아서 이해를 봅는다.
   >
   > ```
   > def GenerateUserReport():
   > # 이 사용자를 위한 lock를 얻는다.
   > ...
   > # 데이터베이스에서 사용자의 정보를 얻는다.
   > ...
   > # 정보를 파일에 작성한다.
   > ...
   > # 사용자를 위한 lock를 되돌려놓는다.
   > ```



## 글을 쓰는 두려움을 떨쳐라.

>코드를 쉽게 이해할 수 있도록 해야겠다고 생각이 들거나 주석을 적어야 겠다고 생각이 들면 일단 떠오르는 생각을 그냥적는다. 그리고, 적은 주석을 보고 무엇이 개선되어야하는지 확인하고 개선하는 작업을 반복한다.
>
>주석을 부지런하게 작성해봐야 주석을 작성하는 실력이 늘어난다.
>그리고, 주석을 그때 그때 작성해야 한꺼번에 몰아서 작성하는 페혜를 막을 수 있다.





출처 : [변방의 프로그래머](https://developside.tistory.com/17?category=657168)

